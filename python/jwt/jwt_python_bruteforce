#!/bin/python
import hashlib
import hmac
import base64


jwt = "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyIjpudWxsfQ.Tr0VvdP6rVBGBGuI_luxGCOaz6BbhC6IxRTlKOW8UjM"

header, data, signature = jwt.split('.')

# print(header)
# print SSL._CERTIFICATE_PATH_LOCATIONS


def sign(data, secret):
    return base64.urlsafe_b64encode(hmac.new(secret, data, digestmod=hashlib.sha256).digest()).replace('=', '')



f = open('password_list.txt', 'r')

for line in f:
    if sign(header+'.'+data, line.strip()) == signature:
        print('password is: ' + line.strip())
        exit()

print('No password found')
f.close()
