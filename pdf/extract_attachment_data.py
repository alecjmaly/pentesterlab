
import PyPDF2

def getAttachments(reader):
  """
  Retrieves the file attachments of the PDF as a dictionary of file names
  and the file data as a bytestring.
  :return: dictionary of filenames and bytestrings
  """
  embeddedFiles = reader.trailer['/Root']['/Names']['/EmbeddedFiles']['/Names']
  
  # embeddedFiles = catalog['/Names']['/EmbeddedFiles']['/Names']
  attachments = {}
  for f in embeddedFiles:
    if isinstance(f, str):
      name = f
      dataIndex = embeddedFiles.index(f) + 1
      fDict = embeddedFiles[dataIndex].getObject()
      fData = fDict['/EF']['/F'].getData()
      attachments[name] = fData

  return attachments


handler = open('C://users/alecm/Downloads/yourfile (8).pdf', 'rb')
reader = PyPDF2.PdfFileReader(handler)

attachments = getAttachments(reader)
print(attachments)


