# Sign jwe with known public key


from jwcrypto import jwk, jwe
from jwcrypto.common import json_encode

pem_file = open('public_key.pem', 'rb')

publicKey = jwk.JWK.from_pem(pem_file.read())

payload = {"user": "admin"}
jwetoken = jwe.JWE(json_encode(payload), json_encode({"alg": "RSA-OAEP", "enc":"A192GCM"}))


print(json_encode(payload))
jwetoken.add_recipient(publicKey)
enc = jwetoken.serialize(compact=True)

print(enc)
